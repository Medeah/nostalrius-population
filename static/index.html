<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Nostalrius Population</title>
</head>

<body>
  <h1>Nostalrius Population</h1> Players online on Nostalrius. Data is updated every 15 min from the main website.
  <div id="chart_div" style="width: 900px; height: 500px"></div>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {
      packages: ['corechart', 'line']
    });
    google.charts.setOnLoadCallback(drawBasic);

    function drawBasic() {
      var data = new google.visualization.DataTable();
      data.addColumn('datetime', 'time');
      data.addColumn('number', 'PvP');
      data.addColumn('number', 'PvE');

      var xhr = new XMLHttpRequest();
      xhr.responseType = 'json';
      xhr.onreadystatechange = handler;
      xhr.open("GET", "data.json");
      xhr.send();

      function handler() {
        if (xhr.readyState == 4 && xhr.status == 200) {
          // Create our data table out of JSON data loaded from server.
          data.addRows(xhr.response.series.map(function(t) {
            return [new Date(t[0]), t[1], t[2]]
          }));

          var options = {
            hAxis: {
              title: 'Time'
            },
            vAxis: {
              title: 'Players'
            },
            explorer: {
              actions: ['dragToZoom', 'rightClickToReset'],
              axis: 'horizontal'
            }
          };

          var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
          chart.draw(data, options);
        }
      }
    }
  </script>
</body>

</html>
